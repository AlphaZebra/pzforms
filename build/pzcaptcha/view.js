document.addEventListener("DOMContentLoaded",(function(){(async()=>{const e=document.querySelectorAll(".wp-block-pzforms-pzcaptcha");if(!e.length)return;const r=e[0].dataset.sitekey;if(!r||!/^[A-Za-z0-9_-]{30,50}$/.test(r))return void e.forEach((e=>{e.innerHTML='<p class="components-placeholder__error">Invalid reCAPTCHA site key format.</p>'}));const o=document.createElement("script");o.src="https://www.google.com/recaptcha/api.js?onload=pzCaptchaOnload&render=explicit",o.async=!0,o.defer=!0,window.pzCaptchaOnload=function(){try{e.forEach((e=>{const o=e.dataset.size||"normal",n=e.dataset.theme||"light",t=document.createElement("div");e.appendChild(t),grecaptcha.render(t,{sitekey:r,size:o,theme:n,callback:r=>{console.log("reCAPTCHA callback received token:",r);let o=e.querySelector('input[name="g-recaptcha-response"]');o||(o=document.createElement("input"),o.type="hidden",o.name="g-recaptcha-response",e.appendChild(o),console.log("Created new hidden input for token")),o.value=r,console.log("Token stored in hidden input")},"error-callback":()=>{console.error("reCAPTCHA error occurred")}})}))}catch(r){console.error("Error initializing reCAPTCHA:",r),e.forEach((e=>{e.innerHTML='<p class="components-placeholder__error">Error initializing reCAPTCHA. Please check your site key.</p>'}))}},o.onerror=()=>{e.forEach((e=>{e.innerHTML='<p class="components-placeholder__error">Failed to load reCAPTCHA script.</p>'}))},document.head.appendChild(o)})()}));